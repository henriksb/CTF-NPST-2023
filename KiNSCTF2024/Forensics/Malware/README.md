# Malware

## Oppgavetekst

Som forensic ekspert analyserer du en infisert Windows maskin. Du identifiserer vedlagte fil som du mistenker er malware. Analyser malwaren og avdekk flagget.

Oppgi svaret i formatet: ctf(svar)


## Løsning

Da jeg kjørte viruset fra kommandolinjen, la jeg merke til at det søkte etter en fil. For å finne ut hvilken fil det var snakk om, brukte jeg ProcMon og satte fokus på viruset. Der oppdaget jeg at det lette etter filen `C:\Temp\infected.txt`. Etter å ha opprettet denne filen, kjørte jeg ProcMon igjen, og så at programmet også lette etter spesifikke registernøkler og -verdier. Jeg opprettet disse via Regedit og kjørte programmet på nytt. Denne gangen fikk jeg beskjed om at payloaden var sendt, og basert på bibliotekene og registrene som ble åpnet mot slutten, antok jeg at dataen ble sendt over internett. Jeg brukte derfor Wireshark for å undersøke trafikken, og fant raskt en forbindelse til `c2.kins.no`. Dataen som ble overført var kryptert og uleselige. For å kunne fange opp og lese meldingen, endret jeg hosts-filen for å omdirigere trafikken fra `c2.kins.no` til `localhost`. Deretter satte jeg opp en lytter med Netcat og kjørte programmet på nytt. Da mottok jeg flagget direkte.
